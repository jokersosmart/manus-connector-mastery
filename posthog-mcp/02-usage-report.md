_# PostHog 連結器使用說明報告

作者：Joker

---

本報告旨在詳細說明 PostHog 連結器所提供的所有可用工具，包括其功能、參數、使用範例及預期輸出，以協助使用者充分利用此連結器進行產品分析與使用者行為追蹤。

由於無法直接查詢到已註冊的 MCP 工具列表，本報告中的工具是基於 PostHog 官方 API 文件所推斷的核心功能。這些工具代表了 PostHog 的主要能力，並被設計為符合 Manus 的自然語言操作風格。

## 推斷的工具列表

### 1. 捕獲單一事件 (capture_event)

此工具用於追蹤使用者執行的單一操作或系統中發生的單一事件。

| 參數 | 類型 | 描述 | 是否必須 |
| :--- | :--- | :--- | :--- |
| `event_name` | string | 事件的名稱，例如 `user_signed_up` 或 `viewed_pricing_page`。 | 是 |
| `distinct_id` | string | 用於唯一識別使用者的 ID。 | 是 |
| `properties` | object | 一個包含與事件相關的額外數據的 JSON 物件。 | 否 |

**使用範例：**

> 「幫我記錄一個名為 `viewed_documentation` 的事件，使用者 ID 是 `user-123`，並附帶屬性 `page_path` 為 `/docs/api`。」

**預期輸出：**

一個確認事件已被接收的成功訊息。

### 2. 捕獲批量事件 (capture_batch_events)

當需要一次性發送多個事件時，此工具比單獨發送更有效率。

| 參數 | 類型 | 描述 | 是否必須 |
| :--- | :--- | :--- | :--- |
| `events` | array | 一個事件物件的陣列，每個物件都應包含 `event_name`、`distinct_id` 和可選的 `properties`。 | 是 |

**使用範例：**

> 「幫我批量記錄兩個事件：第一個是 `searched_docs`，使用者是 `user-456`，關鍵字是 `feature flags`；第二個是 `clicked_result`，使用者也是 `user-456`，連結是 `/docs/feature-flags`。」

**預期輸出：**

一個確認事件批次已被接收的成功訊息。

### 3. 查詢分析洞察 (get_insights)

此工具用於從 PostHog 獲取預先定義或即時計算的分析洞察，例如趨勢、漏斗、留存率等。

| 參數 | 類型 | 描述 | 是否必須 |
| :--- | :--- | :--- | :--- |
| `insight_id` | integer | 要查詢的已儲存洞察的 ID。 | 否 |
| `insight_query` | object | 用於即時計算洞察的查詢物件，需遵循 PostHog 的查詢語法。 | 否 |

**使用範例：**

> 「幫我獲取 ID 為 `54321` 的分析洞察數據。」
> 「幫我查詢過去 7 天內，新使用者註冊的趨勢分析。」

**預期輸出：**

一個包含洞察數據的 JSON 物件，通常會包含圖表數據和相關的統計數字。

### 4. 獲取使用者資訊 (get_persons)

用於檢索符合特定條件的使用者列表及其屬性。

| 參數 | 類型 | 描述 | 是否必須 |
| :--- | :--- | :--- | :--- |
| `distinct_id` | string | 查詢特定使用者的唯一 ID。 | 否 |
| `properties` | object | 用於篩選使用者的屬性條件。 | 否 |
| `limit` | integer | 返回的使用者數量上限。 | 否 |

**使用範例：**

> 「幫我找出屬性中 `country` 為 `USA` 的所有使用者。」
> 「幫我查詢 ID 為 `user-789` 的使用者詳細資訊。」

**預期輸出：**

一個包含使用者列表的 JSON 物件，每個使用者物件包含其 `distinct_id` 和所有屬性。

### 5. 獲取功能旗標 (get_feature_flags)

此工具用於列出專案中所有可用的功能旗標及其當前設定。

| 參數 | 類型 | 描述 | 是否必須 |
| :--- | :--- | :--- | :--- |
| `flag_key` | string | 查詢特定功能旗標的鍵名。 | 否 |

**使用範例：**

> 「幫我列出目前所有的功能旗標。」
> 「幫我查詢 `new-dashboard-ui` 這個功能旗標的詳細設定。」

**預期輸出：**

一個包含功能旗標列表的 JSON 物件，每個物件包含旗標的鍵名、啟用狀態、變體等資訊。

### 6. 評估功能旗標 (evaluate_feature_flag)

用於判斷某個特定的使用者是否應該啟用某個功能旗標。

| 參數 | 類型 | 描述 | 是否必須 |
| :--- | :--- | :--- | :--- |
| `flag_key` | string | 要評估的功能旗標的鍵名。 | 是 |
| `distinct_id` | string | 要評估的目標使用者的唯一 ID。 | 是 |

**使用範例：**

> 「幫我評估一下，使用者 `user-abc` 是否應該啟用 `beta-feature` 這個功能旗標？」

**預期輸出：**

一個布林值 (`true` 或 `false`)，表示該使用者是否滿足啟用條件。如果是多變體旗標，則可能返回變體的鍵名。

### 7. 建立使用者群組 (create_cohort)

此工具允許根據一組條件動態或靜態地建立一個使用者群組 (Cohort)。

| 參數 | 類型 | 描述 | 是否必須 |
| :--- | :--- | :--- | :--- |
| `name` | string | 新群組的名稱。 | 是 |
| `description` | string | 對群組的簡短描述。 | 否 |
| `groups` | array | 定義群組成員的規則陣列。 | 是 |

**使用範例：**

> 「幫我建立一個名為『歐洲高活躍使用者』的群組，條件是使用者屬性 `country` 在 `['France', 'Germany', 'UK']` 中，並且在過去 30 天內至少有 10 次 `login` 事件。」

**預期輸出：**

一個包含新建立群組詳細資訊的 JSON 物件，包括其 ID。

### 8. 獲取會話錄製 (get_session_recordings)

用於檢索特定使用者或符合特定條件的會話錄製列表。

| 參數 | 類型 | 描述 | 是否必須 |
| :--- | :--- | :--- | :--- |
| `distinct_id` | string | 查詢特定使用者的會話錄製。 | 否 |
| `session_id` | string | 查詢單個會話錄製的 ID。 | 否 |
| `events` | array | 篩選包含特定事件的會話。 | 否 |

**使用範例：**

> 「幫我找出使用者 `user-xyz` 最近的 5 個會話錄製。」
> 「幫我找出所有包含 `rageclick` 事件的會話錄製。」

**預期輸出：**

一個包含會話錄製列表的 JSON 物件，每個物件包含錄製的 ID、持續時間、使用者 ID 以及一個用於播放的連結。
