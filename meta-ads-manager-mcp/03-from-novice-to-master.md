_# 「Cloudflare API」從新手到精通指南

**作者：Joker**

---

歡迎來到「Cloudflare API」連結器的世界！本指南將帶您踏上一段從基礎到進階的旅程，無論您是初次接觸 Cloudflare 自動化的開發者，還是經驗豐富的維運工程師，都能在這裡找到一條清晰的學習路徑，最終掌握使用自然語言駕馭 Cloudflare 強大生態的藝術。

我們的目標不僅是教您如何使用工具，更是要傳遞一種全新的工作哲學：將繁瑣的手動點擊（ClickOps）轉化為高效、可複用、可組合的自動化流程，將您的寶貴時間釋放出來，專注於真正具有創造性的工作。

## 第一階段：思想啟蒙 - 為什麼需要自動化？

在深入技術細節之前，我們必須先回答一個根本問題：為什麼要用 Manus 連結器來操作 Cloudflare？

答案，源於我們在《遞迴分析報告》中揭示的核心矛盾：**現代應用架構的敏捷性需求，與傳統手動點擊式管理方式之間存在根本的效率矛盾。**

> 想像一下，您正在開發一個 Jamstack 應用，每次修改程式碼後，都需要手動登入 Cloudflare 儀表板，更新 Pages 部署、清除相關快取、將新版本的資源資訊寫入 KV…… 這個過程不僅耗時，而且極易出錯。當團隊擴大、專案變多時，這種「維運稅」將會呈指數級增長，最終拖垮整個開發流程。

本連結器的誕生，正是為了解決這一痛點。它將 Cloudflare 的 API 封裝成一個個直觀的、可透過自然語言調用的「工具」，讓您能像與同事對話一樣，完成複雜的雲端資源管理任務。這不僅是效率的提升，更是工作模式的革命。

## 第二階段：核心功能 - 掌握您的雲端積木

了解「為什麼」之後，我們來學習「有什麼」。此連結器提供了對 Cloudflare 核心產品的全面支援，它們是您搭建自動化大廈的基礎積木。

| 服務 | 核心價值 | Manus 連結器提供的能力 | 典型場景 |
| :--- | :--- | :--- | :--- |
| **Workers KV** | 全域鍵值儲存 | 建立/刪除/列出命名空間 | 功能開關、A/B 測試分流、短期快取 |
| **R2** | 零出口費物件儲存 | 建立/刪除/列出儲存桶 | 靜態網站託管、多媒體檔案儲存、備份歸檔 |
| **D1** | 無伺服器 SQL 資料庫 | 建立/刪除/查詢資料庫 | 使用者資料、訂單記錄、結構化資料儲存 |
| **Workers** | 邊緣運算平台 | 列出/獲取 Worker 詳情與程式碼 | API 閘道、身分驗證、動態修改請求/回應 |
| **Hyperdrive** | 全球資料庫加速器 | 列出/獲取/刪除設定 | 加速對傳統關聯式資料庫的存取 |

**學習建議：**

1.  **從最熟悉的開始：** 如果您是前端開發者，可以先從 R2 和 KV 開始，它們與靜態網站部署密切相關。
2.  **動手實驗：** 不要只看不練。嘗試用連結器建立一個 KV 命名空間，再刪除它。感受一下指令與結果之間的直接對應關係。
3.  **閱讀《使用說明報告》：** 當您對某個工具的具體參數有疑問時，請隨時查閱 `02-usage-report.md`，它有最詳盡的解釋。

## 第三階段：進階技巧 - 組合與編排的力量

掌握了單個積木後，真正的樂趣在於將它們組合起來，解決真實世界的複雜問題。這也是「文件賦能」核心價值的體現。

### 技巧一：一鍵建立開發環境

**目標：** 為新的功能分支 `feature-x` 快速建立一套獨立的後端資源，包含一個 KV 命名空間和一個 D1 資料庫。

**思路：** 連續調用 `kv_namespace_create` 和 `d1_database_create` 工具。

**自然語言指令範例：**

> 「幫我建立一個名為 `feature-x-kv` 的 KV 命名空間，然後再建立一個名為 `feature-x-db` 的 D1 資料庫。」

**Manus 執行過程：**

1.  調用 `cloudflare.kv_namespace_create`，參數為 `{'title': 'feature-x-kv'}`。
2.  調用 `cloudflare.d1_database_create`，參數為 `{'name': 'feature-x-db'}`。

### 技巧二：自動化 CI/CD 發布流程

**目標：** 在網站成功部署到 Cloudflare Pages 後，自動將新版本的靜態資源 URL 更新到 KV 中，供其他服務讀取。

**思路：** 這通常在 CI/CD 腳本中完成。腳本在完成 Pages 部署後，可以透過呼叫 Manus 的 API 來執行 `kv_write_key_value` (假設有此工具) 指令。

**自然語言指令範例 (在 CI/CD 腳本中觸發)：**

> 「將 `my-app-config` KV 命名空間中的 `latest_assets_url` 這個鍵的值更新為 `https://new-version.pages.dev`。」

### 技巧三：動態路由與 A/B 測試

**目標：** 使用 Worker 根據請求的 Header，將流量動態導向到 R2 中的不同版本網站。

**思路：**

1.  在 R2 中存放 `v1` 和 `v2` 兩個版本的網站檔案。
2.  編寫一個 Worker 腳本，該腳本會讀取一個 KV 中的設定值 (例如 `ab_test_config`)。
3.  此設定值決定了要將多少比例的流量導向 `v2`。
4.  您可以使用 `kv_write_key_value` 工具隨時調整 KV 中的設定，從而動態控制流量分配，無需重新部署 Worker。

**自然語言指令範例：**

> 「把 `ab_testing` KV 命名空間裡 `routing_config` 的值改成 `{'version': 'v2', 'ratio': 0.5}`，我要把 50% 的流量切到 v2 版本。」

## 第四階段：實戰應用 - 打造一個無伺服器短網址服務

讓我們將所有知識融會貫通，打造一個完整的應用。

- **核心架構：** Worker + D1
- **運作流程：**
    1.  使用者透過一個簡單的管理頁面，或直接用 Manus 指令，新增一個短網址映射 (例如 `short.com/g` -> `google.com`)。
    2.  這個映射關係被寫入 D1 資料庫的一個表中 (`short_urls`)。
    3.  當有使用者訪問 `short.com/g` 時，Cloudflare Worker 會被觸發。
    4.  Worker 腳本從 URL 路徑中提取 `g`，然後查詢 D1 資料庫。
    5.  如果找到對應的長網址 `google.com`，Worker 就會回傳一個 301/302 重新導向的回應。
    6.  如果沒找到，則回傳 404 頁面。

**使用 Manus 連結器管理此服務：**

- **新增短網址：**
  > 「在 `short-url-db` D1 資料庫中執行 SQL 查詢：`INSERT INTO short_urls (short, long) VALUES ('g', 'https://google.com');`」
- **查詢所有短網址：**
  > 「幫我查詢 `short-url-db` D1 資料庫，執行 `SELECT * FROM short_urls;`」
- **刪除短網址：**
  > 「在 `short-url-db` D1 資料庫中執行 SQL：`DELETE FROM short_urls WHERE short = 'g';`」

這個實戰案例完美地展示了如何將 Cloudflare 的無伺服器產品與 Manus 的自然語言自動化能力結合，創造出輕量、強大且極易管理的應用程式。

## 第五階段：成為大師 - 您的專屬學習路徑

精通之路因人而異。根據您的角色，我們推薦以下學習路徑：

- **對於 DevOps / SRE 工程師：**
  1.  **重點：** 自動化、監控、基礎設施即代碼 (IaC)。
  2.  **路徑：** 從「進階技巧」中的 CI/CD 整合開始，深入研究如何將 Manus 指令嵌入到您現有的 Terraform 或 Ansible 工作流中。探索使用 `hyperdrive` 加速後端資料庫，並思考如何自動化災難恢復流程。

- **對於前端 / 全端開發者：**
  1.  **重點：** 開發效率、無伺服器應用。
  2.  **路徑：** 從「實戰應用」的短網址服務開始，嘗試自己動手搭建一個完整的 Serverless 應用。深入探索 `Workers` + `KV` / `D1` / `R2` 的組合，打造如動態 OG 圖片生成、Serverless 表單處理等功能。

- **對於專案經理 / 技術主管：**
  1.  **重點：** 團隊效率、成本控制、技術選型。
  2.  **路徑：** 重點理解「第一階段」的核心思想，並思考如何將這種自動化文化引入團隊。利用 `accounts_list` 和 `*_list` 系列工具，快速盤點團隊的雲端資源使用情況，找出可被自動化的重複性工作。

## 結語

從新手到精通，不是一蹴可幾的過程，而是一個不斷學習、實踐、反思的循環。本指南為您提供了一張地圖，但真正的旅程需要您親自去探索。

請記住，Manus「Cloudflare API」連結器的終極目標是成為您思考的延伸，讓您能專注於「做什麼」，而不是「如何做」。現在，就開始您的自動化之旅吧！
